!function(e){function t(t){let n;const l=e(t).val(),s=e(t).attr("class"),o=s.split(/\s+/);s&&o.length&&o.forEach((t=>{let s=t.split("_"),o=s[s.length-1],i=s.slice(0,-1);n=JSON.parse(JSON.stringify(dropdownDependency[t][o]));let c=n;i.forEach((t=>{const n=e(`#select-${t}`);let l=e(n).val();if(Array.isArray(l)||(l=[l]),l.length&&l[0].length)for(const e in c)l.some((n=>c[e][t].includes(n)))||delete c[e]})),0===l.length&&0===c.length&&(c=dropdownDependency[t][o],e(`#${o}`).trigger("updateSelectedItems",[[]]));const d={[o]:c},a=e(`#select-${o}`).attr("class").split(/\s+/),r=e(`#select-${o}`).attr("data-custom"),p=e(`#select-${o}`).attr("data-role");e(`#${o}`).CustomDropDown({dropdownData:d,displayName:p,dependency:a,settings:dropdownDependency[r],depsettings:r})}))}function n(t){const l=e(t).attr("class");if(l){l.split(/\s+/).forEach((t=>{let l=t.split("_"),s=l[l.length-1];l.slice(0,-1).forEach((t=>{let l=e(`#select-${s}`).val();e(`#select-${s}`).attr("class")&&l.length&&n(e(`#select-${s}`));let o=e(`#select-${t}`).val();o&&o.length&&e(`#select-${s}`).trigger("updateSelectedItems",[[]])}))}))}}e.fn.CustomDropDown=function(l){return this.each((function(){const s=e(this),o=s.attr("id");if(!o)return void console.error("Element does not have an ID.");const i=l.dependency||"",c=l.displayName||"Select Option",d=l.settings||{},a=l.depsettings||"",r=l.dropdownData||{};s.data("selectedItems",l.selectedItem);const p=s.data("selectedItems")||[];!function(l,s,o,i,c,d,a){const r=l[s],p=e(`#${s}`);if(!r||!p.length)return void console.error(`Dropdown data or container not found for ID '${s}'.`);p.empty();const u=Array.isArray(i)?i.join(" "):i,g=e("<select>",{id:`select-${s}`,name:`select-${s}`,class:u,"data-custom":d,"data-role":a,multiple:"multi"===c.SelectFeature&&"multiple",style:"display:none;"});function f(e){if("multi"!==e.SelectFeature)return 40;{let t=0;if(1==e.Counting&&t++,1==e.SelectAll&&t++,1==e.ClearAll&&t++,1==e.DropDownIcon&&t++,4===t)return 100;if(3===t&&1==e.Counting)return 90;if(3===t&&0==e.Counting)return 60;if(2===t&&1==e.Counting)return 70;if(2===t&&0==e.Counting)return 40;if(1===t&&1==e.Counting)return 50;if(1===t&&0==e.Counting)return 20;if(0===t)return 0}}g.on("change",(function(){t(this)})),p.append(g);const h=f(c);let $;$=60===h?63:100===h?109:90===h?93:70===h?73:40===h?43:50===h?55:20===h?25:0;const m=e("<div>",{class:"custom-dropdown"}).append(`\n            <div class="selected-values">\n                ${1==c.Searchable&&Object.keys(r).length?`<input type="text" placeholder="Search..." class="search-filter hidden" style="max-width: calc(100% - ${h}px); flex: 1; ${c.FontSize?`font-size: ${c.FontSize}px;`:""}" id="dropdown-search-${s}">`:""}\n                <div class="selected-items" style="max-width: calc(100% - ${h}px);"><span id="select-text">${a}</span></div>\n                ${1==c.Counting||1==c.SelectAll||1==c.ClearAll||1==c.DropDownIcon?'<div class="divider"></div>':""}\n                <div class="dropdown-buttons">\n                ${1==c.Counting&&"multi"===c.SelectFeature?`<div id="selected-count-${s}" class="selected-count" ${c.FontSize?`style="font-size: ${c.FontSize}px"`:""}>0</div>`:""}\n                ${1==c.SelectAll&&"multi"===c.SelectFeature?`<img class="select-all" id="select-all-${s}" src="${c.SelectAllImg?c.SelectAllImg:""}" alt="" ${c.IconSize?`style="width: ${c.IconSize}px"`:""}>`:""}\n                ${1==c.SelectAll&&1==c.DeselectAll&&"multi"===c.SelectFeature?`<img class="deselect-all" id="deselect-all-${s}" src="${c.DeselectAllImg?c.DeselectAllImg:""}" alt="" ${c.IconSize?`style="width: ${c.IconSize}px"`:""}>`:""}\n                ${1==c.ClearAll?`<img class="clear-all" id="clear-all-${s}" src="${c.ClearAllImg?c.ClearAllImg:""}" alt="" ${c.IconSize?`style="width: ${c.IconSize}px"`:""}>`:""}\n                ${1==c.DropDownIcon?`<img class="drop-down-all" id="drop-down-all-${s}" src="${c.DropDownIconImg?c.DropDownIconImg:""}" alt="" ${c.IconSize?`style="width: ${c.IconSize}px"`:""}>`:""}\n                </div>\n            </div>\n            <div class="dropdown-content hidden">\n                <div class="dropdown-list"></div>\n            </div>\n        `);c.DropDownSize&&m.css("width",`${c.DropDownSize}px`);p.append(m),function(t,l,s,o,i,c,d){const a=t.find(".dropdown-content"),r=t.find(".selected-values"),p=e(`#select-all-${s}`),u=e(`#deselect-all-${s}`),g=e(`#clear-all-${s}`),f=t.find(".selected-items"),h=e(`#selected-count-${s}`),$=t.find(".dropdown-list"),m=e(`#dropdown-search-${s}`),S=t.find("#select-text");let v=[];if(null==c.SelectFeature||"single"===c.SelectFeature){const t=e("<option>",{value:"",text:"single"});o.append(t)}for(const[t,n]of Object.entries(l)){const l=n.name||t,s=e("<option>",{value:t,text:l});o.append(s),i.includes(t)&&(v.push(t),s.prop("selected",!0))}I(),D(),r.on("click",(n=>{var s;n.stopPropagation(),s=t,e(".custom-dropdown").each((function(){if(!e(this).is(s)){e(this).find(".dropdown-content").addClass("hidden");const t=e(this).find(".search-filter");t.addClass("hidden"),t.val(""),t.trigger("input"),e(this).find(".selected-items").removeClass("hidden")}})),a.toggleClass("hidden"),Object.keys(l).length&&(f.toggleClass("hidden"),m.toggleClass("hidden"),a.hasClass("hidden")?(m.val(""),m.trigger("input")):m.focus())})),"multi"===c.SelectFeature&&a.on("click",(e=>{e.stopPropagation()}));function w(t=""){$.empty();const n=Object.entries(l).filter((([e,n])=>n.name.toLowerCase().includes(t.toLowerCase()))),s=e(document.createDocumentFragment()),o=e(document.createDocumentFragment());0===n.length?$.append(`<div style="padding: 5px; color: #888; ${c.FontSize?`font-size: ${c.FontSize}px`:""}">No data found</div>`):(n.forEach((([t,n])=>{const l=n.name,i=e("<div>").text(l).attr("title",l).addClass(v.includes(t)?"selected":"unselected");c.FontSize&&i.css("font-size",`${c.FontSize}px`),i.on("click",(e=>{"multi"===c.SelectFeature&&e.stopPropagation(),y(t,l)})),v.includes(t)?s.append(i):o.append(i)})),$.append(s),$.append(o))}function y(t,l){if(n(e(`#select-${s}`)),null==c.SelectFeature||"single"===c.SelectFeature)v=[t],o.find("option").prop("selected",!1),o.find(`option[value="${t}"]`).prop("selected",!0);else{const e=v.indexOf(t);e>-1?(v.splice(e,1),o.find(`option[value="${t}"]`).prop("selected",!1)):(v.push(t),o.find(`option[value="${t}"]`).prop("selected",!0))}I(),w(m.val()),D(),o.trigger("change")}function D(){v.length===Object.keys(l).length?(p.hide(),u.show()):(p.show(),u.hide())}function I(){f.empty(),h.text(v.length).attr("title",v.length),0===v.length?(S.text(`${d}`),c.FontSize&&S.css("font-size",`${c.FontSize}px`),f.append(S)):v.forEach((t=>{const n=l[t].name,s=e("<span>").text(n),o=e("<span>",{text:"Ã—",class:"remove-icon"});c.FontSize&&(s.css("font-size",`${c.FontSize}px`),o.css("font-size",`${c.FontSize}px`)),o.on("click",(e=>{e.stopPropagation(),z(t)})),s.append(o),f.append(s)})),t.trigger("updateSelectedItems",[v]),D()}function z(t){n(e(`#select-${s}`)),v=v.filter((e=>e!==t)),o.find(`option[value="${t}"]`).prop("selected",!1),I(),w(m.val()),o.trigger("change")}m.on("click",(e=>{e.stopPropagation()})),e(document).on("click",(e=>{t.is(e.target)||0!==t.has(e.target).length||(a.addClass("hidden"),Object.keys(l).length&&(m.addClass("hidden"),m.val(""),m.trigger("input"),f.removeClass("hidden")))})),p.on("click",(()=>{v=Object.keys(l),o.find("option").prop("selected",!0),I(),w(),o.trigger("change")})),u.on("click",(()=>{n(e(`#select-${s}`)),v=[],o.find("option").prop("selected",!1),I(),w(),o.trigger("change")})),g.on("click",(()=>{n(e(`#select-${s}`)),v=[],o.find("option").prop("selected",!1),I(),w(),o.trigger("change")})),m.on("input",(()=>{w(m.val())})),w(),D()}(m,r,s,g,o,c,a)}(r,o,p,i,d,a,c),setTimeout((()=>{t(e(`#select-${o}`))}),100),s.on("updateSelectedItems",(function(e,t){s.data("selectedItems",t)}))}))}}(jQuery);
