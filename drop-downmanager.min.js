!function(e){e.fn.CustomDropDown=function(t){return this.each((function(){const n=e(this),o=n.attr("id");if(!o)return void console.error("Element does not have an ID.");const s=t.dependency||"",l=t.settings||{},c=t.depsettings||"";!function(t,n,o,s,l,c){const i=t[n],d=e(`#${n}`);if(!i||!d.length)return void console.error(`Dropdown data or container not found for ID '${n}'.`);d.empty();const a=Array.isArray(s)?s.join(" "):s,r=e("<select>",{id:`select-${n}`,name:`select-${n}`,class:a,"data-custom":c,multiple:"multiple",style:"display:none;"});function p(e){let t=0;return e.Counting&&t++,e.SelectAll&&t++,e.ClearAll&&t++,e.DropDownIcon&&t++,4===t?100:3===t&&e.Counting?90:3!==t||e.Counting?2===t&&e.Counting?70:2!==t||e.Counting?1===t&&e.Counting?50:1!==t||e.Counting?0===t?0:void 0:20:40:60}r.on("change",(function(){!function(t){let n;const o=e(t).val(),s=e(t).attr("class"),l=s.split(/\s+/);s&&l.length&&l.forEach((t=>{let s=t.split("_"),l=s[s.length-1],c=s.slice(0,-1);n=Object.entries(dropdownDependency[t][l]);let i=n;c.forEach((t=>{let n=i.filter((([n,o])=>{if(o[t]&&Array.isArray(o[t])){const n=e(`#select-${t}`),s=e(n).val();if(s.length)return o[t].some((e=>s.includes(e)))}return!1}));0!=n.length&&n.length<=i.length&&(i=n)})),0===o.length&&0==i.length&&(i=Object.entries(dropdownDependency[t][l]),e(`#${l}`).trigger("updateSelectedItems",[[]])),0===o.length&&e(`#${l}`).trigger("updateSelectedItems",[[]]);const d={[l]:Object.fromEntries(i)},a=e(`#select-${l}`).attr("class").split(/\s+/),r=e(`#select-${l}`).attr("data-custom");e(`#${l}`).CustomDropDown({dropdownData:d,dependency:a,settings:dropdownDependency[r],depsettings:r})}))}(this)})),d.append(r);const u=p(l),g=e("<div>",{class:"custom-dropdown"}).append(`\n            <div class="selected-values">\n                <div class="selected-items" style="max-width: calc(100% - ${u}px);"><span id="select-text">Select ${n}</span></div>\n                ${l.Counting||l.SelectAll||l.ClearAll||l.DropDownIcon?'<div class="divider"></div>':""}\n                <div class="dropdown-buttons">\n                ${l.Counting?`<div id="selected-count-${n}" class="selected-count" ${l.FontSize?`style="font-size: ${l.FontSize}px"`:""}>0</div>`:""}\n                ${l.SelectAll?`<img class="select-all" id="select-all-${n}" src="${l.SelectAllImg}" alt="" ${l.IconSize?`style="width: ${l.IconSize}px"`:""}>`:""}\n                ${l.SelectAll&&l.DeselectAll?`<img class="deselect-all" id="deselect-all-${n}" src="${l.DeselectAllImg}" alt="" ${l.IconSize?`style="width: ${l.IconSize}px"`:""}>`:""}\n                ${l.ClearAll?`<img class="clear-all" id="clear-all-${n}" src="${l.ClearAllImg}" alt="" ${l.IconSize?`style="width: ${l.IconSize}px"`:""}>`:""}\n                ${l.DropDownIcon?`<img class="drop-down-all" id="drop-down-all-${n}" src="${l.DropDownIconImg}" alt="" ${l.IconSize?`style="width: ${l.IconSize}px"`:""}>`:""}\n                </div>\n            </div>\n            <div class="dropdown-content hidden">\n            ${l.Searchable?`<input type="text" placeholder="Search..." id="dropdown-search-${n}" ${l.FontSize?`style="font-size: ${l.FontSize}px"`:""}>`:""}\n                <div class="dropdown-list"></div>\n            </div>\n        `);l.DropDownSize&&g.css("width",`${l.DropDownSize}px`);d.append(g),function(t,n,o,s,l,c){const i=t.find(".dropdown-content"),d=t.find(".selected-values"),a=e(`#select-all-${o}`),r=e(`#deselect-all-${o}`),p=e(`#clear-all-${o}`),u=t.find(".selected-items"),g=e(`#selected-count-${o}`),h=t.find(".dropdown-list"),$=e(`#dropdown-search-${o}`),f=t.find("#select-text");let m=[];for(const[t,o]of Object.entries(n)){const n=o.name||t,c=e("<option>",{value:t,text:n});s.append(c),l.includes(t)&&(m.push(t),c.prop("selected",!0))}function w(t=""){h.empty();const o=Object.entries(n).filter((([e,n])=>n.name.toLowerCase().includes(t.toLowerCase()))),s=e(document.createDocumentFragment()),l=e(document.createDocumentFragment());0===o.length?h.append(`<div style="padding: 5px; color: #888; ${c.FontSize?`font-size: ${c.FontSize}px`:""}">No data found</div>`):(o.forEach((([t,n])=>{const o=n.name,i=e("<div>").text(o).addClass(m.includes(t)?"selected":"unselected");c.FontSize&&i.css("font-size",`${c.FontSize}px`),i.on("click",(e=>{e.stopPropagation(),v(t,o)})),m.includes(t)?s.append(i):l.append(i)})),h.append(s),h.append(l))}function v(e,t){const n=m.indexOf(e);n>-1?(m.splice(n,1),s.find(`option[value="${e}"]`).prop("selected",!1)):(m.push(e),s.find(`option[value="${e}"]`).prop("selected",!0)),z(),w($.val()),S(),s.trigger("change")}function S(){m.length===Object.keys(n).length?(a.hide(),r.show()):(a.show(),r.hide())}function z(){u.empty(),g.text(m.length),0===m.length?(f.text(`Select ${o}`),c.FontSize&&f.css("font-size",`${c.FontSize}px`),u.append(f)):m.forEach((t=>{const o=n[t].name,s=e("<span>").text(o),l=e("<span>",{text:"Ã—",class:"remove-icon"});c.FontSize&&(s.css("font-size",`${c.FontSize}px`),l.css("font-size",`${c.FontSize}px`)),l.on("click",(e=>{e.stopPropagation(),D(t)})),s.append(l),u.append(s)})),t.trigger("updateSelectedItems",[m]),S()}function D(e){m=m.filter((t=>t!==e)),s.find(`option[value="${e}"]`).prop("selected",!1),z(),w($.val()),s.trigger("change")}z(),S(),d.on("click",(n=>{var o;n.stopPropagation(),o=t,e(".custom-dropdown .dropdown-content").each((function(){e(this).closest(".custom-dropdown").is(o)||e(this).addClass("hidden")})),i.toggleClass("hidden"),i.hasClass("hidden")||$.focus()})),i.on("click",(e=>{e.stopPropagation()})),e(document).on("click",(e=>{t.is(e.target)||0!==t.has(e.target).length||i.addClass("hidden")})),a.on("click",(()=>{m=Object.keys(n),s.find("option").prop("selected",!0),z(),w(),s.trigger("change")})),r.on("click",(()=>{m=[],s.find("option").prop("selected",!1),z(),w(),s.trigger("change")})),p.on("click",(()=>{m=[],s.find("option").prop("selected",!1),z(),w(),s.trigger("change")})),$.on("input",(()=>{w($.val())})),w(),S()}(g,i,n,r,o,l)}(t.dropdownData||{},o,n.data("selectedItems")||[],s,l,c),n.on("updateSelectedItems",(function(e,t){n.data("selectedItems",t)}))}))}}(jQuery);
