!function(e){function t(t){let n;const l=e(t).val(),o=e(t).attr("class"),i=o.split(/\s+/);o&&i.length&&i.forEach((t=>{let o=t.split("_"),i=o[o.length-1],s=o.slice(0,-1);n=JSON.parse(JSON.stringify(dropdownDependency[t][i]));let c=n;s.forEach((t=>{const n=e(`#select-${t}`);let l=e(n).val();if(Array.isArray(l)||(l=[l]),l.length&&l[0].length)for(const e in c)l.some((n=>c[e][t].includes(n)))||delete c[e]})),0===l.length&&0===c.length&&(c=dropdownDependency[t][i],e(`#${i}`).trigger("updateSelectedItems",[[]])),0===l.length&&e(`#${i}`).trigger("updateSelectedItems",[[]]);const d={[i]:c},a=e(`#select-${i}`).attr("class").split(/\s+/),r=e(`#select-${i}`).attr("data-custom");e(`#${i}`).CustomDropDown({dropdownData:d,dependency:a,settings:dropdownDependency[r],depsettings:r})}))}e.fn.CustomDropDown=function(n){return this.each((function(){const l=e(this),o=l.attr("id");if(!o)return void console.error("Element does not have an ID.");const i=n.dependency||"",s=n.settings||{},c=n.depsettings||"",d=n.dropdownData||{};l.data("selectedItems",n.selectedItem);const a=l.data("selectedItems")||[];!function(n,l,o,i,s,c){const d=n[l],a=e(`#${l}`);if(!d||!a.length)return void console.error(`Dropdown data or container not found for ID '${l}'.`);a.empty();const r=Array.isArray(i)?i.join(" "):i,p=e("<select>",{id:`select-${l}`,name:`select-${l}`,class:r,"data-custom":c,multiple:"multi"===s.SelectFeature&&"multiple",style:"display:none;"});function u(e){if("multi"!==e.SelectFeature)return 40;{let t=0;if(1==e.Counting&&t++,1==e.SelectAll&&t++,1==e.ClearAll&&t++,1==e.DropDownIcon&&t++,4===t)return 100;if(3===t&&1==e.Counting)return 90;if(3===t&&0==e.Counting)return 60;if(2===t&&1==e.Counting)return 70;if(2===t&&0==e.Counting)return 40;if(1===t&&1==e.Counting)return 50;if(1===t&&0==e.Counting)return 20;if(0===t)return 0}}p.on("change",(function(){t(this)})),a.append(p);const g=u(s);let f;f=60===g?63:100===g?109:90===g?93:70===g?73:40===g?43:50===g?55:20===g?25:0;const h=e("<div>",{class:"custom-dropdown"}).append(`\n            <div class="selected-values">\n                ${1==s.Searchable&&Object.keys(d).length?`<input type="text" placeholder="Search..." class="search-filter hidden" style="max-width: calc(100% - ${g}px); flex: 1; ${s.FontSize?`font-size: ${s.FontSize}px;`:""}" id="dropdown-search-${l}">`:""}\n                <div class="selected-items" style="max-width: calc(100% - ${g}px);"><span id="select-text">Select ${l}</span></div>\n                ${1==s.Counting||1==s.SelectAll||1==s.ClearAll||1==s.DropDownIcon?'<div class="divider"></div>':""}\n                <div class="dropdown-buttons">\n                ${1==s.Counting&&"multi"===s.SelectFeature?`<div id="selected-count-${l}" class="selected-count" ${s.FontSize?`style="font-size: ${s.FontSize}px"`:""}>0</div>`:""}\n                ${1==s.SelectAll&&"multi"===s.SelectFeature?`<img class="select-all" id="select-all-${l}" src="${s.SelectAllImg?s.SelectAllImg:""}" alt="" ${s.IconSize?`style="width: ${s.IconSize}px"`:""}>`:""}\n                ${1==s.SelectAll&&1==s.DeselectAll&&"multi"===s.SelectFeature?`<img class="deselect-all" id="deselect-all-${l}" src="${s.DeselectAllImg?s.DeselectAllImg:""}" alt="" ${s.IconSize?`style="width: ${s.IconSize}px"`:""}>`:""}\n                ${1==s.ClearAll?`<img class="clear-all" id="clear-all-${l}" src="${s.ClearAllImg?s.ClearAllImg:""}" alt="" ${s.IconSize?`style="width: ${s.IconSize}px"`:""}>`:""}\n                ${1==s.DropDownIcon?`<img class="drop-down-all" id="drop-down-all-${l}" src="${s.DropDownIconImg?s.DropDownIconImg:""}" alt="" ${s.IconSize?`style="width: ${s.IconSize}px"`:""}>`:""}\n                </div>\n            </div>\n            <div class="dropdown-content hidden">\n                <div class="dropdown-list"></div>\n            </div>\n        `);s.DropDownSize&&h.css("width",`${s.DropDownSize}px`);a.append(h),function(t,n,l,o,i,s){const c=t.find(".dropdown-content"),d=t.find(".selected-values"),a=e(`#select-all-${l}`),r=e(`#deselect-all-${l}`),p=e(`#clear-all-${l}`),u=t.find(".selected-items"),g=e(`#selected-count-${l}`),f=t.find(".dropdown-list"),h=e(`#dropdown-search-${l}`),m=t.find("#select-text");let $=[];if(null==s.SelectFeature||"single"===s.SelectFeature){const t=e("<option>",{value:"",text:"single"});o.append(t)}for(const[t,l]of Object.entries(n)){const n=l.name||t,s=e("<option>",{value:t,text:n});o.append(s),i.includes(t)&&($.push(t),s.prop("selected",!0))}D(),w(),d.on("click",(l=>{var o;l.stopPropagation(),o=t,e(".custom-dropdown").each((function(){if(!e(this).is(o)){e(this).find(".dropdown-content").addClass("hidden");const t=e(this).find(".search-filter");t.addClass("hidden"),t.val(""),t.trigger("input"),e(this).find(".selected-items").removeClass("hidden")}})),c.toggleClass("hidden"),Object.keys(n).length&&(u.toggleClass("hidden"),h.toggleClass("hidden"),c.hasClass("hidden")?(h.val(""),h.trigger("input")):h.focus())})),"multi"===s.SelectFeature&&c.on("click",(e=>{e.stopPropagation()}));function S(t=""){f.empty();const l=Object.entries(n).filter((([e,n])=>n.name.toLowerCase().includes(t.toLowerCase()))),o=e(document.createDocumentFragment()),i=e(document.createDocumentFragment());0===l.length?f.append(`<div style="padding: 5px; color: #888; ${s.FontSize?`font-size: ${s.FontSize}px`:""}">No data found</div>`):(l.forEach((([t,n])=>{const l=n.name,c=e("<div>").text(l).attr("title",l).addClass($.includes(t)?"selected":"unselected");s.FontSize&&c.css("font-size",`${s.FontSize}px`),c.on("click",(e=>{"multi"===s.SelectFeature&&e.stopPropagation(),v(t,l)})),$.includes(t)?o.append(c):i.append(c)})),f.append(o),f.append(i))}function v(e,t){if(null==s.SelectFeature||"single"===s.SelectFeature)$=[e],o.find("option").prop("selected",!1),o.find(`option[value="${e}"]`).prop("selected",!0);else{const t=$.indexOf(e);t>-1?($.splice(t,1),o.find(`option[value="${e}"]`).prop("selected",!1)):($.push(e),o.find(`option[value="${e}"]`).prop("selected",!0))}D(),S(h.val()),w(),o.trigger("change")}function w(){$.length===Object.keys(n).length?(a.hide(),r.show()):(a.show(),r.hide())}function D(){u.empty(),g.text($.length).attr("title",$.length),0===$.length?(m.text(`Select ${l}`),s.FontSize&&m.css("font-size",`${s.FontSize}px`),u.append(m)):$.forEach((t=>{const l=n[t].name,o=e("<span>").text(l),i=e("<span>",{text:"Ã—",class:"remove-icon"});s.FontSize&&(o.css("font-size",`${s.FontSize}px`),i.css("font-size",`${s.FontSize}px`)),i.on("click",(e=>{e.stopPropagation(),I(t)})),o.append(i),u.append(o)})),t.trigger("updateSelectedItems",[$]),w()}function I(e){$=$.filter((t=>t!==e)),o.find(`option[value="${e}"]`).prop("selected",!1),D(),S(h.val()),o.trigger("change")}h.on("click",(e=>{e.stopPropagation()})),e(document).on("click",(e=>{t.is(e.target)||0!==t.has(e.target).length||(c.addClass("hidden"),Object.keys(n).length&&(h.addClass("hidden"),h.val(""),h.trigger("input"),u.removeClass("hidden")))})),a.on("click",(()=>{$=Object.keys(n),o.find("option").prop("selected",!0),D(),S(),o.trigger("change")})),r.on("click",(()=>{$=[],o.find("option").prop("selected",!1),D(),S(),o.trigger("change")})),p.on("click",(()=>{$=[],o.find("option").prop("selected",!1),D(),S(),o.trigger("change")})),h.on("input",(()=>{S(h.val())})),S(),w()}(h,d,l,p,o,s)}(d,o,a,i,s,c),setTimeout((()=>{t(e(`#select-${o}`))}),100),l.on("updateSelectedItems",(function(e,t){l.data("selectedItems",t)}))}))}}(jQuery);
